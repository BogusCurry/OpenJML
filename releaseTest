#! /bin/sh

## This file tests a release of the OpenJML tool
## This is just a quick "smoke" test to make sure that 
## the tool runs on simple inputs
## It is intended to be run with the OpenJML project directory as its 
## current working directory

REL=$1
if [[ "$REL" == "" ]] ; then REL=`ls -t *gz | head -1` ; fi
echo Testing $REL

rm -rf temp
mkdir temp
cp $REL temp
cd temp
tar zxf *gz
ls
java -jar openjml.jar
echo "public class A { /*@ invariant 0; */ }" > A.java
echo "public class B { /*@ invariant true; */ }" > B.java
java -jar openjml.jar -version
java -jar openjml.jar -specs . B.java
java -jar openjml.jar -specs . A.java
java -jar openjml.jar -specs . B.java -jmlverbose
java -jar openjml.jar -specs . B.java -jmlverbose -noInternalSpecs

cd ..
rm -rf temp
